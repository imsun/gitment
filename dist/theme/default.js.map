{"version":3,"sources":["../../src/theme/default.js"],"names":["renderHeader","instance","meta","user","reactions","container","document","createElement","className","likeButton","likedReaction","find","reaction","login","innerHTML","heart","classList","add","onclick","unlike","remove","like","appendChild","issueLink","href","html_url","target","innerText","renderComments","comments","error","errorBlock","owner","initHint","initButton","setAttribute","init","catch","removeAttribute","alert","e","undefined","loading","length","emptyBlock","commentsList","forEach","createDate","Date","comment","created_at","updateDate","updated_at","commentItem","avatar_url","toDateString","toString","marked","body","renderEditor","shouldDisable","disabledTip","loginning","loginLink","querySelector","logout","writeField","previewField","textarea","oninput","style","height","window","getComputedStyle","parseInt","clientHeight","scrollHeight","querySelectorAll","writeTab","previewTab","focus","content","value","trim","submitButton","post","then","state","push","data","renderFooter","render"],"mappings":";;;;;;;;AAAA;;AACA;;AAEA,SAASA,YAAT,OAAiDC,QAAjD,EAA2D;AAAA,MAAnCC,IAAmC,QAAnCA,IAAmC;AAAA,MAA7BC,IAA6B,QAA7BA,IAA6B;AAAA,MAAvBC,SAAuB,QAAvBA,SAAuB;;AACzD,MAAMC,YAAYC,SAASC,aAAT,CAAuB,KAAvB,CAAlB;AACAF,YAAUG,SAAV,GAAsB,kCAAtB;;AAEA,MAAMC,aAAaH,SAASC,aAAT,CAAuB,MAAvB,CAAnB;AACA,MAAMG,gBAAgBN,UAAUO,IAAV,CAAe;AAAA,WAAYC,SAAST,IAAT,CAAcU,KAAd,KAAwBV,KAAKU,KAAzC;AAAA,GAAf,CAAtB;AACAJ,aAAWD,SAAX,GAAuB,oBAAvB;AACAC,aAAWK,SAAX,yCAEKJ,gBACC,QADD,GAEC,MAJN,gBAMKR,KAAKE,SAAL,IAAkBF,KAAKE,SAAL,CAAeW,KAAjC,wBACeb,KAAKE,SAAL,CAAeW,KAD9B,uBAEC,EARN;AAWA,MAAIL,aAAJ,EAAmB;AACjBD,eAAWO,SAAX,CAAqBC,GAArB,CAAyB,OAAzB;AACAR,eAAWS,OAAX,GAAqB;AAAA,aAAMjB,SAASkB,MAAT,EAAN;AAAA,KAArB;AACD,GAHD,MAGO;AACLV,eAAWO,SAAX,CAAqBI,MAArB,CAA4B,OAA5B;AACAX,eAAWS,OAAX,GAAqB;AAAA,aAAMjB,SAASoB,IAAT,EAAN;AAAA,KAArB;AACD;AACDhB,YAAUiB,WAAV,CAAsBb,UAAtB;;AAEA,MAAMc,YAAYjB,SAASC,aAAT,CAAuB,GAAvB,CAAlB;AACAgB,YAAUf,SAAV,GAAsB,sBAAtB;AACAe,YAAUC,IAAV,GAAiBtB,KAAKuB,QAAtB;AACAF,YAAUG,MAAV,GAAmB,QAAnB;AACAH,YAAUI,SAAV,GAAsB,YAAtB;AACAtB,YAAUiB,WAAV,CAAsBC,SAAtB;;AAEA,SAAOlB,SAAP;AACD;;AAED,SAASuB,cAAT,QAAmD3B,QAAnD,EAA6D;AAAA,MAAnC4B,QAAmC,SAAnCA,QAAmC;AAAA,MAAzB1B,IAAyB,SAAzBA,IAAyB;AAAA,MAAnB2B,KAAmB,SAAnBA,KAAmB;;AAC3D,MAAMzB,YAAYC,SAASC,aAAT,CAAuB,KAAvB,CAAlB;AACAF,YAAUG,SAAV,GAAsB,oCAAtB;;AAEA,MAAIsB,KAAJ,EAAW;AACT,QAAMC,aAAazB,SAASC,aAAT,CAAuB,KAAvB,CAAnB;AACAwB,eAAWvB,SAAX,GAAuB,mBAAvB;;AAEA,QAAIsB,8CAAmC3B,KAAKU,KAAL,KAAeZ,SAAS+B,KAA/D,EAAsE;AACpE,UAAMC,WAAW3B,SAASC,aAAT,CAAuB,KAAvB,CAAjB;AACA,UAAM2B,aAAa5B,SAASC,aAAT,CAAuB,QAAvB,CAAnB;AACA2B,iBAAW1B,SAAX,GAAuB,sBAAvB;AACA0B,iBAAWhB,OAAX,GAAqB,YAAM;AACzBgB,mBAAWC,YAAX,CAAwB,UAAxB,EAAoC,IAApC;AACAlC,iBAASmC,IAAT,GACGC,KADH,CACS,aAAK;AACVH,qBAAWI,eAAX,CAA2B,UAA3B;AACAC,gBAAMC,CAAN;AACD,SAJH;AAKD,OAPD;AAQAN,iBAAWP,SAAX,GAAuB,qBAAvB;AACAM,eAASX,WAAT,CAAqBY,UAArB;AACAH,iBAAWT,WAAX,CAAuBW,QAAvB;AACD,KAfD,MAeO;AACLF,iBAAWJ,SAAX,GAAuBG,KAAvB;AACD;AACDzB,cAAUiB,WAAV,CAAsBS,UAAtB;AACA,WAAO1B,SAAP;AACD,GAxBD,MAwBO,IAAIwB,aAAaY,SAAjB,EAA4B;AACjC,QAAMC,UAAUpC,SAASC,aAAT,CAAuB,KAAvB,CAAhB;AACAmC,YAAQf,SAAR,GAAoB,qBAApB;AACAe,YAAQlC,SAAR,GAAoB,qBAApB;AACAH,cAAUiB,WAAV,CAAsBoB,OAAtB;AACA,WAAOrC,SAAP;AACD,GANM,MAMA,IAAI,CAACwB,SAASc,MAAd,EAAsB;AAC3B,QAAMC,aAAatC,SAASC,aAAT,CAAuB,KAAvB,CAAnB;AACAqC,eAAWpC,SAAX,GAAuB,mBAAvB;AACAoC,eAAWjB,SAAX,GAAuB,gBAAvB;AACAtB,cAAUiB,WAAV,CAAsBsB,UAAtB;AACA,WAAOvC,SAAP;AACD;;AAED,MAAMwC,eAAevC,SAASC,aAAT,CAAuB,IAAvB,CAArB;AACAsC,eAAarC,SAAb,GAAyB,kBAAzB;;AAEAqB,WAASiB,OAAT,CAAiB,mBAAW;AAC1B,QAAMC,aAAa,IAAIC,IAAJ,CAASC,QAAQC,UAAjB,CAAnB;AACA,QAAMC,aAAa,IAAIH,IAAJ,CAASC,QAAQG,UAAjB,CAAnB;AACA,QAAMC,cAAc/C,SAASC,aAAT,CAAuB,IAAvB,CAApB;AACA8C,gBAAY7C,SAAZ,GAAwB,YAAxB;AACA6C,gBAAYvC,SAAZ,mDACuCmC,QAAQ9C,IAAR,CAAasB,QADpD,4EAE8CwB,QAAQ9C,IAAR,CAAamD,UAF3D,kJAMyCL,QAAQ9C,IAAR,CAAasB,QANtD,wCAOUwB,QAAQ9C,IAAR,CAAaU,KAPvB,yEAUqBkC,UAVrB,UAUoCA,WAAWQ,YAAX,EAVpC,4BAWSR,WAAWS,QAAX,OAA0BL,WAAWK,QAAX,EAA1B,mDAC0CL,UAD1C,uBAEC,EAbV,gEAgBmClD,SAASwD,MAAT,CAAgBR,QAAQS,IAAxB,CAhBnC;AAmBAb,iBAAavB,WAAb,CAAyB+B,WAAzB;AACD,GAzBD;;AA2BAhD,YAAUiB,WAAV,CAAsBuB,YAAtB;;AAEA,SAAOxC,SAAP;AACD;;AAED,SAASsD,YAAT,QAAgC1D,QAAhC,EAA0C;AAAA,MAAlBE,IAAkB,SAAlBA,IAAkB;;AACxC,MAAME,YAAYC,SAASC,aAAT,CAAuB,KAAvB,CAAlB;AACAF,YAAUG,SAAV,GAAsB,kCAAtB;;AAEA,MAAMoD,gBAAgBzD,KAAKU,KAAL,GAAa,EAAb,GAAkB,UAAxC;AACA,MAAMgD,cAAc1D,KAAKU,KAAL,GAAa,EAAb,GAAkB,kBAAtC;AACAR,YAAUS,SAAV,iBACOX,KAAKU,KAAL,0CACsCV,KAAKsB,QAD3C,8EAE4CtB,KAAKmD,UAFjD,2BAICnD,KAAK2D,SAAL,yGAEuC7D,SAAS8D,SAFhD,wFALR,gUAmBW5D,KAAKU,KAAL,GACC,6CADD,GAECV,KAAK2D,SAAL,GACE,cADF,8CAE2C7D,SAAS8D,SAFpD,4BArBZ,mLA6ByDF,WA7BzD,UA6ByED,aA7BzE,qbAuCgDC,WAvChD,UAuCgED,aAvChE;AA2CA,MAAIzD,KAAKU,KAAT,EAAgB;AACdR,cAAU2D,aAAV,CAAwB,wBAAxB,EAAkD9C,OAAlD,GAA4D;AAAA,aAAMjB,SAASgE,MAAT,EAAN;AAAA,KAA5D;AACD;;AAED,MAAMC,aAAa7D,UAAU2D,aAAV,CAAwB,wBAAxB,CAAnB;AACA,MAAMG,eAAe9D,UAAU2D,aAAV,CAAwB,0BAAxB,CAArB;;AAEA,MAAMI,WAAWF,WAAWF,aAAX,CAAyB,UAAzB,CAAjB;AACAI,WAASC,OAAT,GAAmB,YAAM;AACvBD,aAASE,KAAT,CAAeC,MAAf,GAAwB,MAAxB;AACA,QAAMD,QAAQE,OAAOC,gBAAP,CAAwBL,QAAxB,EAAkC,IAAlC,CAAd;AACA,QAAMG,SAASG,SAASJ,MAAMC,MAAf,EAAuB,EAAvB,CAAf;AACA,QAAMI,eAAeP,SAASO,YAA9B;AACA,QAAMC,eAAeR,SAASQ,YAA9B;AACA,QAAID,eAAeC,YAAnB,EAAiC;AAC/BR,eAASE,KAAT,CAAeC,MAAf,GAAyBA,SAASK,YAAT,GAAwBD,YAAzB,GAAyC,IAAjE;AACD;AACF,GATD;;AAzDwC,8BAoETtE,UAAUwE,gBAAV,CAA2B,gBAA3B,CApES;AAAA;AAAA,MAoEjCC,QApEiC;AAAA,MAoEvBC,UApEuB;;AAqExCD,WAAS5D,OAAT,GAAmB,YAAM;AACvB4D,aAAS9D,SAAT,CAAmBC,GAAnB,CAAuB,UAAvB;AACA8D,eAAW/D,SAAX,CAAqBI,MAArB,CAA4B,UAA5B;AACA8C,eAAWlD,SAAX,CAAqBI,MAArB,CAA4B,QAA5B;AACA+C,iBAAanD,SAAb,CAAuBC,GAAvB,CAA2B,QAA3B;;AAEAmD,aAASY,KAAT;AACD,GAPD;AAQAD,aAAW7D,OAAX,GAAqB,YAAM;AACzB6D,eAAW/D,SAAX,CAAqBC,GAArB,CAAyB,UAAzB;AACA6D,aAAS9D,SAAT,CAAmBI,MAAnB,CAA0B,UAA1B;AACA+C,iBAAanD,SAAb,CAAuBI,MAAvB,CAA8B,QAA9B;AACA8C,eAAWlD,SAAX,CAAqBC,GAArB,CAAyB,QAAzB;;AAEA,QAAMgE,UAAUb,SAASc,KAAT,CAAeC,IAAf,MAAyB,oBAAzC;AACAhB,iBAAaH,aAAb,CAA2B,oBAA3B,EAAiDlD,SAAjD,GAA6Db,SAASwD,MAAT,CAAgBwB,OAAhB,CAA7D;AACD,GARD;;AAUA,MAAMG,eAAe/E,UAAU2D,aAAV,CAAwB,mBAAxB,CAArB;AACAoB,eAAalE,OAAb,GAAuB,YAAM;AAC3BkE,iBAAazD,SAAb,GAAyB,eAAzB;AACAyD,iBAAajD,YAAb,CAA0B,UAA1B,EAAsC,IAAtC;AACAlC,aAASoF,IAAT,CAAcjB,SAASc,KAAT,CAAeC,IAAf,EAAd,EACGG,IADH,CACQ,gBAAQ;AACZlB,eAASc,KAAT,GAAiB,EAAjB;AACAjF,eAASsF,KAAT,CAAe1D,QAAf,CAAwB2D,IAAxB,CAA6BC,IAA7B;AACAL,mBAAa9C,eAAb,CAA6B,UAA7B;AACA8C,mBAAazD,SAAb,GAAyB,SAAzB;AACD,KANH,EAOGU,KAPH,CAOS,aAAK;AACVE,YAAMC,CAAN;AACA4C,mBAAa9C,eAAb,CAA6B,UAA7B;AACA8C,mBAAazD,SAAb,GAAyB,SAAzB;AACD,KAXH;AAYD,GAfD;;AAiBA,SAAOtB,SAAP;AACD;;AAED,SAASqF,YAAT,GAAwB;AACtB,MAAMrF,YAAYC,SAASC,aAAT,CAAuB,KAAvB,CAAlB;AACAF,YAAUG,SAAV,GAAsB,kCAAtB;AACAH,YAAUS,SAAV;AAMA,SAAOT,SAAP;AACD;;AAED,SAASsF,MAAT,CAAgBJ,KAAhB,EAAuBtF,QAAvB,EAAiC;AAC/B,MAAMI,YAAYC,SAASC,aAAT,CAAuB,KAAvB,CAAlB;AACAF,YAAUG,SAAV,GAAsB,gCAAtB;AACAH,YAAUiB,WAAV,CAAsBrB,SAASD,YAAT,CAAsBuF,KAAtB,EAA6BtF,QAA7B,CAAtB;AACAI,YAAUiB,WAAV,CAAsBrB,SAAS2B,cAAT,CAAwB2D,KAAxB,EAA+BtF,QAA/B,CAAtB;AACAI,YAAUiB,WAAV,CAAsBrB,SAAS0D,YAAT,CAAsB4B,KAAtB,EAA6BtF,QAA7B,CAAtB;AACAI,YAAUiB,WAAV,CAAsBrB,SAASyF,YAAT,CAAsBH,KAAtB,EAA6BtF,QAA7B,CAAtB;AACA,SAAOI,SAAP;AACD;;kBAEc,EAAEsF,cAAF,EAAU3F,0BAAV,EAAwB4B,8BAAxB,EAAwC+B,0BAAxC,EAAsD+B,0BAAtD,E","file":"default.js","sourcesContent":["import { github as githubIcon, heart as heartIcon, spinner as spinnerIcon } from '../icons'\nimport { NOT_INITIALIZED_ERROR } from '../constants'\n\nfunction renderHeader({ meta, user, reactions }, instance) {\n  const container = document.createElement('div')\n  container.className = 'gc-container gc-header-container'\n\n  const likeButton = document.createElement('span')\n  const likedReaction = reactions.find(reaction => reaction.user.login === user.login)\n  likeButton.className = 'gc-header-like-btn'\n  likeButton.innerHTML = `\n    ${heartIcon}\n    ${ likedReaction\n      ? 'Unlike'\n      : 'Like'\n    }\n    ${ meta.reactions && meta.reactions.heart\n      ? ` • <strong>${meta.reactions.heart}</strong> Liked`\n      : ''\n    }\n  `\n  if (likedReaction) {\n    likeButton.classList.add('liked')\n    likeButton.onclick = () => instance.unlike()\n  } else {\n    likeButton.classList.remove('liked')\n    likeButton.onclick = () => instance.like()\n  }\n  container.appendChild(likeButton)\n\n  const issueLink = document.createElement('a')\n  issueLink.className = 'gc-header-issue-link'\n  issueLink.href = meta.html_url\n  issueLink.target = '_blank'\n  issueLink.innerText = 'Issue Page'\n  container.appendChild(issueLink)\n\n  return container\n}\n\nfunction renderComments({ comments, user, error }, instance) {\n  const container = document.createElement('div')\n  container.className = 'gc-container gc-comments-container'\n\n  if (error) {\n    const errorBlock = document.createElement('div')\n    errorBlock.className = 'gc-comments-error'\n\n    if (error === NOT_INITIALIZED_ERROR && user.login === instance.owner) {\n      const initHint = document.createElement('div')\n      const initButton = document.createElement('button')\n      initButton.className = 'gc-comments-init-btn'\n      initButton.onclick = () => {\n        initButton.setAttribute('disabled', true)\n        instance.init()\n          .catch(e => {\n            initButton.removeAttribute('disabled')\n            alert(e)\n          })\n      }\n      initButton.innerText = 'Initialize Comments'\n      initHint.appendChild(initButton)\n      errorBlock.appendChild(initHint)\n    } else {\n      errorBlock.innerText = error\n    }\n    container.appendChild(errorBlock)\n    return container\n  } else if (comments === undefined) {\n    const loading = document.createElement('div')\n    loading.innerText = 'Loading comments...'\n    loading.className = 'gc-comments-loading'\n    container.appendChild(loading)\n    return container\n  } else if (!comments.length) {\n    const emptyBlock = document.createElement('div')\n    emptyBlock.className = 'gc-comments-empty'\n    emptyBlock.innerText = 'No Comment Yet'\n    container.appendChild(emptyBlock)\n    return container\n  }\n\n  const commentsList = document.createElement('ul')\n  commentsList.className = 'gc-comments-list'\n\n  comments.forEach(comment => {\n    const createDate = new Date(comment.created_at)\n    const updateDate = new Date(comment.updated_at)\n    const commentItem = document.createElement('li')\n    commentItem.className = 'gc-comment'\n    commentItem.innerHTML = `\n      <a class=\"gc-comment-avatar\" href=\"${comment.user.html_url}\" target=\"_blank\">\n        <img class=\"gc-comment-avatar-img\" src=\"${comment.user.avatar_url}\"/>\n      </a>\n      <div class=\"gc-comment-main\">\n        <div class=\"gc-comment-header\">\n          <a class=\"gc-comment-name\" href=\"${comment.user.html_url}\" target=\"_blank\">\n            ${comment.user.login}\n          </a>\n          commented on\n          <span title=\"${createDate}\">${createDate.toDateString()}</span>\n          ${ createDate.toString() !== updateDate.toString()\n            ? ` • <span title=\"comment was edited at ${updateDate}\">edited</span>`\n            : ''\n          }\n        </div>\n        <div class=\"gc-comment-body\">${instance.marked(comment.body)}</div>\n      </div>\n    `\n    commentsList.appendChild(commentItem)\n  })\n\n  container.appendChild(commentsList)\n\n  return container\n}\n\nfunction renderEditor({ user }, instance) {\n  const container = document.createElement('div')\n  container.className = 'gc-container gc-editor-container'\n\n  const shouldDisable = user.login ? '' : 'disabled'\n  const disabledTip = user.login ? '' : 'Login to Comment'\n  container.innerHTML = `\n      ${ user.login\n        ? `<a class=\"gc-editor-avatar\" href=\"${user.html_url} target=\"_blank\">\n            <img class=\"gc-editor-avatar-img\" src=\"${user.avatar_url}\"/>\n          </a>`\n        : user.loginning\n          ? `<div class=\"gc-editor-avatar\">${spinnerIcon}</div>`\n          : `<a class=\"gc-editor-avatar\" href=\"${instance.loginLink}\" title=\"login with GitHub\">\n              ${githubIcon}\n            </a>`\n      }\n    </a>\n    <div class=\"gc-editor-main\">\n      <div class=\"gc-editor-header\">\n        <nav class=\"gc-editor-tabs\">\n          <button class=\"gc-editor-tab selected\">Write</button>\n          <button class=\"gc-editor-tab\">Preview</button>\n        </nav>\n        <div class=\"gc-editor-login\">\n          ${ user.login\n            ? '<a class=\"gc-editor-logout-link\">Logout</a>'\n            : user.loginning\n              ? 'Loginning...'\n              : `<a class=\"gc-editor-login-link\" href=\"${instance.loginLink}\">Login</a> with GitHub`\n          }\n        </div>\n      </div>\n      <div class=\"gc-editor-body\">\n        <div class=\"gc-editor-write-field\">\n          <textarea placeholder=\"Leave a comment\" title=\"${disabledTip}\" ${shouldDisable}></textarea>\n        </div>\n        <div class=\"gc-editor-preview-field hidden\">\n          <div class=\"gc-editor-preview\"></div>\n        </div>\n      </div>\n      <div class=\"gc-editor-footer\">\n        <a class=\"gc-editor-footer-tip\" href=\"https://guides.github.com/features/mastering-markdown/\" target=\"_blank\">\n          Styling with Markdown is supported\n        </a>\n        <button class=\"gc-editor-submit\" title=\"${disabledTip}\" ${shouldDisable}>Comment</button>\n      </div>\n    </div>\n  `\n  if (user.login) {\n    container.querySelector('.gc-editor-logout-link').onclick = () => instance.logout()\n  }\n\n  const writeField = container.querySelector('.gc-editor-write-field')\n  const previewField = container.querySelector('.gc-editor-preview-field')\n\n  const textarea = writeField.querySelector('textarea')\n  textarea.oninput = () => {\n    textarea.style.height = 'auto'\n    const style = window.getComputedStyle(textarea, null)\n    const height = parseInt(style.height, 10)\n    const clientHeight = textarea.clientHeight\n    const scrollHeight = textarea.scrollHeight\n    if (clientHeight < scrollHeight) {\n      textarea.style.height = (height + scrollHeight - clientHeight) + 'px'\n    }\n  }\n\n  const [writeTab, previewTab] = container.querySelectorAll('.gc-editor-tab')\n  writeTab.onclick = () => {\n    writeTab.classList.add('selected')\n    previewTab.classList.remove('selected')\n    writeField.classList.remove('hidden')\n    previewField.classList.add('hidden')\n\n    textarea.focus()\n  }\n  previewTab.onclick = () => {\n    previewTab.classList.add('selected')\n    writeTab.classList.remove('selected')\n    previewField.classList.remove('hidden')\n    writeField.classList.add('hidden')\n\n    const content = textarea.value.trim() || 'Nothing to preview'\n    previewField.querySelector('.gc-editor-preview').innerHTML = instance.marked(content)\n  }\n\n  const submitButton = container.querySelector('.gc-editor-submit')\n  submitButton.onclick = () => {\n    submitButton.innerText = 'Submitting...'\n    submitButton.setAttribute('disabled', true)\n    instance.post(textarea.value.trim())\n      .then(data => {\n        textarea.value = ''\n        instance.state.comments.push(data)\n        submitButton.removeAttribute('disabled')\n        submitButton.innerText = 'Comment'\n      })\n      .catch(e => {\n        alert(e)\n        submitButton.removeAttribute('disabled')\n        submitButton.innerText = 'Comment'\n      })\n  }\n\n  return container\n}\n\nfunction renderFooter() {\n  const container = document.createElement('div')\n  container.className = 'gc-container gc-footer-container'\n  container.innerHTML = `\n    Powered by\n    <a class=\"gc-footer-project-link\" href=\"https://github.com/imsun/gh-comments\" target=\"_blank\">\n      gh-comments\n    </a>\n  `\n  return container\n}\n\nfunction render(state, instance) {\n  const container = document.createElement('div')\n  container.className = 'gc-container gc-root-container'\n  container.appendChild(instance.renderHeader(state, instance))\n  container.appendChild(instance.renderComments(state, instance))\n  container.appendChild(instance.renderEditor(state, instance))\n  container.appendChild(instance.renderFooter(state, instance))\n  return container\n}\n\nexport default { render, renderHeader, renderComments, renderEditor, renderFooter }\n"]}